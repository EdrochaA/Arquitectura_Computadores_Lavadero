;Variables
ESTADO EQU R0
EVENTO EQU R1
ANT0 EQU R2
ACT0 EQU R3
ANT1 EQU R4
ACT1 EQU R5
ANT2 EQU R6
ACT3 EQU R7

;Puerto P0
SEM_VERDE EQU P0.0
SEM_ROJO EQU P0.1
S_PLAT EQU P0.2
FICHA_TIPO EQU P0.3
S_FICHA EQU P0.4
P_START EQU P0.5
AL_START EQU P0.6
BPOS_START EQU P0.7

;Puerto P1
BMOV_FRONT EQU P1.0
BMOV_BACK EQU P1.1
FC_RH_TOP EQU P1.2
RH_UPTO EQU P1.3
RH_DOWNTO  EQU P1.4
FC_RV_BORDE EQU P1.5
RV_OUTTO EQU P1.6
RV_INTO EQU P1.7

;Puerto P2
EV_AGUA EQU P2.0
EV_JABON EQU P2.1
S_CAR EQU P2.3
FC_RV_CENTRO EQU P2.4
LED_LNOR EQU P2.5
LED_LINT EQU P2.6

;Variables
tick_5s EQU 0x20.0

;#########################################################################
;			INTERRUPCIONES
;#########################################################################
;ORG 0x0B			;TIMER0
;	ACALL SUB_TIMER		; 5s

;*********************** TIMER *******************************************
;SUBTIMER:
;	PUSH ACC
;	PUSH PSW
;	MOV TH0,
;	MOV TL0,
;	SETB tick_5s
;	INC cont_5s
;	MOV A, cont_5s
;	CLR C
;	SUBB 
;#########################################################################
;			PROGRAMA PRINCIPAL
;#########################################################################
ORG	0x00
	ACALL INICIO
INICIO:
	ACALL INICIALIZAR
BUCLE:
	;ACALL GEN_EVE
	ACALL MAQ_ESTADOS
	AJMP BUCLE


;#########################################################################
;			INICIALIZACIONES
;#########################################################################

INICIALIZAR:
	MOV ESTADO, #0x00
	MOV EVENTO, #0x00
	MOV ANT, #0x00
	MOV ACT, #0x00
	SETB SEM_VERDE
	CLR SEM_ROJO
	CLR S_PLAT
	CLR FICHA_TIPO	
	CLR S_FICHA	
	CLR P_START	
	CLR AL_START	
	CLR BPOS_START	
	CLR BMOV_FRONT	
	CLR BMOV_BACK	
	CLR FC_RH_TOP	
	CLR RH_UPTO	
	CLR RH_DOWNTO	
	CLR FC_RV_BORDE
	CLR RV_OUTTO	
	CLR RH_INTO
	CLR EV_AGUA
	CLR EV_JABON
	CLR S_CAR
	CLR FC_RV_CENTRO
	CLR LED_LNOR
	CLR LED_LINT
	RET
;#########################################################################
;			MÁQUINA DE ESTADOS
;#########################################################################

MAQ_ESTADOS:
	MOV A, ESTADO
	RL A
	MOV DPTR, #LISTA_EST
	JMP @A+DPTR

LISTA_EST:
	AJMP ESPERA_COCHE;   Estado0
	AJMP COCHE_PUESTO;   Estado1
	AJMP ALARMA;         Estado2
	AJMP PONER_PUENTE;   Estado3
	AJMP ENJABONADO;     Estado4
	AJMP LIMPIAR_ATRAS;  Estado5
	AJMP PONER_RODILLOS; Estado6
	AJMP RODILLOS;       Estado7
	AJMP LIMPIAR_DELANTE;Estado8
	AJMP ACLARADO;       Estado9
	AJMP SECADO;         Estado10
	AJMP RETIRAR_COCHE;  Estado11
	

;#########################################################################
;			ESTADO 0
;#########################################################################

ESPERA_COCHE:
    

    ; VERIFICACION DE LOS BITS DEL PUERTO 0
    MOV A, ACT0             
    MOV ANT0, A              ; Dar valores a ACT y ANT
    MOV ACT0, P0

    MOV A, ACT0              
    XRL A, ANT0              ; XOR con el valor anterior para detectar cambios
    JZ PUERTO1_0           
    MOV B, ANT0


    ; Verificación para bit 0.2 (S_PLAT)
    MOV C, ACC.2   
    JNC S_FICHA_0     
    MOV C, B.2
    JNC ASCENDENTE_SPLAT_0 ; Si ANT.2 era 0 y cambió a 1, es un flanco ascendente
    JC DESCENDENTE_SPLAT_0   ; Si ANT.2 era 1 y cambió a 0, es un flanco descendente

    ASCENDENTE_SPLAT_0:
    MOV EVENTO, #0x02    ; EVENTO 2
    ACALL MAQ_EVENTOS_0
    SJMP S_FICHA_0

    DESCENDENTE_SPLAT_0:
    MOV EVENTO, #0x03    ; EVENTO 3
    ACALL MAQ_EVENTOS_0


    ; Verificación para bit 0.4 (S_FICHA)
    S_FICHA_0:        

    MOV C, ACC.4   
    JNC P_START_0     
    MOV C, B.4
    JNC ASCENDENTE_SFICHA_0 ; Si ANT.2 era 0 y cambió a 1, es un flanco ascendente

    ASCENDENTE_SFICHA_0:
    MOV EVENTO, #0x05    ; EVENTO 5
    SJMP P_START_0
    ACALL MAQ_EVENTOS_0


    ; Verificación para bit 0.5 (P_START)
    P_START_0:    

    MOV C, ACC.5   
    JNC PUERTO1_0     
    MOV C, B.5
    JNC ASCENDENTE_PSTART_0 ; Si ANT.2 era 0 y cambió a 1, es un flanco ascendente

    ASCENDENTE_PSTART_0:
    MOV EVENTO, #0x06    ; EVENTO 6
    SJMP PUERTO1_0
    ACALL MAQ_EVENTOS_0



    ; VERIFICACION DE LOS BITS DEL PUERTO 1
    PUERTO1_0:    	
    MOV A, ACT1             
    MOV ANT1, A              ; Dar valores a ACT y ANT
    MOV ACT1, P1

    MOV A, ACT1              
    XRL A, ANT1              ; XOR con el valor anterior para detectar cambios
    JZ PUERTO2_0           
    MOV B, ANT1

    ; Verificación para bit 1.5 (FC_RV_BORDE)
    FC_RV_BORDE:
    
    MOV C, ACC.5   
    JNC PUERTO2_0     
    MOV C, B.5
    JNC ASCENDENTE_FC_RV_BORDE_0 ; Si ANT.2 era 0 y cambió a 1, es un flanco ascendente

    ASCENDENTE_FC_RV_BORDE_0:
    MOV EVENTO, #0x10    ; EVENTO 16
    SJMP PUERTO2_0    
    ACALL MAQ_EVENTOS_0

    ; VERIFICACION DE LOS BITS DEL PUERTO 2
    PUERTO2_0:
            
    MOV A, ACT2             
    MOV ANT2, A              ; Dar valores a ACT y ANT
    MOV ACT2, P2

    MOV A, ACT2              
    XRL A, ANT2              ; XOR con el valor anterior para detectar cambios
    JZ FIN_0           
    MOV B, ANT2

    ; Verificación para bit 2.3 (S_CAR)
    MOV C, ACC.3   
    JNC FC_RV_CENTRO     
    MOV C, B.3
    JNC ASCENDENTE_SCAR_0   ; Si ANT.2 era 0 y cambió a 1, es un flanco ascendente
    JC DESCENDENTE_SCAR_0   ; Si ANT.2 era 1 y cambió a 0, es un flanco descendente

    ASCENDENTE_SCAR_0:
    MOV EVENTO, #0x08    ; EVENTO 8
    ACALL MAQ_EVENTOS_0
    SJMP FC_RV_CENTRO

    DESCENDENTE_SCAR_0:
    MOV EVENTO, #0x09    ; EVENTO 9

    ACALL MAQ_EVENTOS_0


    ; Verificación para bit 2.4 (FC_RV_CENTRO)
    FC_RV_CENTRO:
    
    MOV C, ACC.4   
    JNC FIN_0     
    MOV C, B.4
    JNC ASCENDENTE_FC_RV_CENTRO_0 ; Si ANT.2 era 0 y cambió a 1, es un flanco ascendente

    ASCENDENTE_FC_RV_CENTRO_0:
    MOV EVENTO, #0x11    ; EVENTO 17
    SJMP FIN_0


    ACALL MAQ_EVENTOS_0





    FIN_0:

    RET



MAQ_EVENTOS_0:
	MOV A, EVENTO
	RL A
	MOV DPTR, #LISTA_EV_0
	JMP @A+DPTR

LISTA_EV_0:
	AJMP EVENTOS0_0
	AJMP EVENTOS0_1
	AJMP EVENTOS0_2
	AJMP EVENTOS0_3
	AJMP EVENTOS0_4
	AJMP EVENTOS0_5
	AJMP EVENTOS0_6
	AJMP EVENTOS0_7
	AJMP EVENTOS0_8
	AJMP EVENTOS0_9
	AJMP EVENTOS0_10
	AJMP EVENTOS0_11
	AJMP EVENTOS0_12
	AJMP EVENTOS0_13
	AJMP EVENTOS0_14
	AJMP EVENTOS0_15
	AJMP EVENTOS0_16
	AJMP EVENTOS0_17
	AJMP EVENTOS0_18
	AJMP EVENTOS0_19
	AJMP EVENTOS0_20
	AJMP EVENTOS0_21
	AJMP EVENTOS0_22
	AJMP EVENTOS0_23

EVENTOS0_0:
	RET

EVENTOS0_1:

	MOV ESTADO, #0x01
	MOV EVENTO, #0x00
        ;AQUI HAY QUE EMPEZAR UN TIMER DE 30s (SI PASAN 30s --> IR AL EVENTO 4)

	RET

EVENTOS0_2:
	SETB SEM_ROJO
	CLR SEM_VERDE
	; AQUI HAY QUE INICIAR EL TIMER DE 5 SEGUNDOS (SI PASAN 5s --> IR AL EVENTO 1)
	MOV EVENTO, #0x00
	RET

EVENTOS0_3:
	SETB SEM_VERDE
	CLR SEM_ROJO
        ; AQUI HAY QUE REINICIAR EL TIMER DE 5 SEGUNDOS
        MOV EVENTO, #0x00
	RET

EVENTOS0_4:
	RET

EVENTOS0_5:
	RET

EVENTOS0_6:
	RET

EVENTOS0_7:
	RET

EVENTOS0_8:

	RET
EVENTOS0_9:
	RET

EVENTOS0_10:
	RET

EVENTOS0_11:
	RET

EVENTOS0_12:
	RET

EVENTOS0_13:
	RET

EVENTOS0_14:
	RET

EVENTOS0_15:
	RET

EVENTOS0_16:
	RET

EVENTOS0_17:
	RET

EVENTOS0_18:
	RET

EVENTOS0_19:
	RET

EVENTOS0_20:
	RET

EVENTOS0_21:
	RET

EVENTOS0_22:
	RET

EVENTOS0_23:
	RET


;#########################################################################
;			ESTADO 1
;#########################################################################
COCHE_PUESTO:

    ACALL MAQ_EVENTOS_1

    RET


MAQ_EVENTOS_1:
	MOV A, EVENTO
	RL A
	MOV DPTR, #LISTA_EV_1
	JMP @A+DPTR
LISTA_EV_1:
	AJMP EVENTOS1_0
	AJMP EVENTOS1_1
	AJMP EVENTOS1_2
	AJMP EVENTOS1_3
	AJMP EVENTOS1_4
	AJMP EVENTOS1_5
	AJMP EVENTOS1_6
	AJMP EVENTOS1_7
	AJMP EVENTOS1_8
	AJMP EVENTOS1_9
	AJMP EVENTOS1_10
	AJMP EVENTOS1_11
	AJMP EVENTOS1_12
	AJMP EVENTOS1_13
	AJMP EVENTOS1_14
	AJMP EVENTOS1_15
	AJMP EVENTOS1_16
	AJMP EVENTOS1_17
	AJMP EVENTOS1_18
	AJMP EVENTOS1_19
	AJMP EVENTOS1_20
	AJMP EVENTOS1_21
	AJMP EVENTOS1_22
	AJMP EVENTOS1_23

EVENTOS1_0:
	RET

EVENTOS1_1:
	RET

EVENTOS1_2:
	RET

EVENTOS1_3:
	RET

EVENTOS1_4:

	MOV ESTADO, #0x02
	SETB AL_START
	;AQUI HAY QUE EMPEZAR OTRO TIMER DE 30s (SI PASAN 30s --> IR AL EVENTO 7)
	MOV EVENTO, #0x00

	RET

EVENTOS1_5:

     JNB FICHA_TIPO, NORMAL
     SETB LED_LNOR
     SJMP INTENSIVO

     NORMAL:
     SETB LED_LINT

     INTENSIVO:
     MOV EVENTO, #0x00
     RET

EVENTOS1_6:
     MOV C, S_FICHA
     JC NO_FICHA_START_1
     MOV ESTADO, #0x03
     SETB BMOV_FRONT

     NO_FICHA_START_1:
     MOV EVENTO, #0x00

	RET

EVENTOS1_7:
	RET

EVENTOS1_8:

	RET
EVENTOS1_9:
	RET

EVENTOS1_10:
	RET

EVENTOS1_11:
	RET

EVENTOS1_12:
	RET

EVENTOS1_13:
	RET

EVENTOS1_14:
	RET

EVENTOS1_15:
	RET

EVENTOS1_16:
	RET

EVENTOS1_17:
	RET

EVENTOS1_18:
	RET

EVENTOS1_19:
	RET

EVENTOS1_20:
	RET

EVENTOS1_21:
	RET

EVENTOS1_22:
	RET

EVENTOS1_23:
	RET


;#########################################################################
;			ESTADO 2
;#########################################################################

ALARMA:
	ACALL MAQ_EVENTOS_2
	RET

MAQ_EVENTOS_2:
	MOV A, EVENTO
	RL A
	MOV DPTR, #LISTA_EV_2
	JMP @A+DPTR

LISTA_EV_2:
	AJMP EVENTOS2_0
	AJMP EVENTOS2_1
	AJMP EVENTOS2_2
	AJMP EVENTOS2_3
	AJMP EVENTOS2_4
	AJMP EVENTOS2_5
	AJMP EVENTOS2_6
	AJMP EVENTOS2_7
	AJMP EVENTOS2_8
	AJMP EVENTOS2_9
	AJMP EVENTOS2_10
	AJMP EVENTOS2_11
	AJMP EVENTOS2_12
	AJMP EVENTOS2_13
	AJMP EVENTOS2_14
	AJMP EVENTOS2_15
	AJMP EVENTOS2_16
	AJMP EVENTOS2_17
	AJMP EVENTOS2_18
	AJMP EVENTOS2_19
	AJMP EVENTOS2_20
	AJMP EVENTOS2_21
	AJMP EVENTOS2_22
	AJMP EVENTOS2_23
EVENTOS2_0:
	RET

EVENTOS2_1:
	RET

EVENTOS2_2:
	RET

EVENTOS2_3:

     MOV ESTADO, #0x00
     MOV EVENTO, #0x00
	RET

EVENTOS2_4:
	RET

EVENTOS2_5:
	RET

EVENTOS2_6:
     MOV C, S_FICHA
     JC NO_FICHA_START_2
     MOV ESTADO, #0x03
     SETB BMOV_FRONT

     NO_FICHA_START_2:
     MOV EVENTO, #0x00
	RET

EVENTOS2_7:
     MOV C, S_FICHA
     JC NO_FICHA_30_2
     MOV ESTADO, #0x03
     SETB BMOV_FRONT

     NO_FICHA_30_2:
     MOV EVENTO, #0x00
	RET

EVENTOS2_8:
	RET

EVENTOS2_9:
	RET

EVENTOS2_10:
	RET

EVENTOS2_11:
	RET

EVENTOS2_12:
	RET

EVENTOS2_13:
	RET

EVENTOS2_14:
	RET

EVENTOS2_15:
	RET

EVENTOS2_16:
	RET

EVENTOS2_17:
	RET

EVENTOS2_18:
	RET

EVENTOS2_19:
	RET

EVENTOS2_20:
	RET

EVENTOS2_21:
	RET

EVENTOS2_22:
	RET

EVENTOS2_23:
	RET

;#########################################################################
;			ESTADO 3
;#########################################################################

PONER_PUENTE:
	ACALL MAQ_EVENTOS_3
	RET

MAQ_EVENTOS_3:
	MOV A, EVENTO
	RL A
	MOV DPTR, #LISTA_EV_3
	JMP @A+DPTR

LISTA_EV_3:
	AJMP EVENTOS3_0
	AJMP EVENTOS3_1
	AJMP EVENTOS3_2
	AJMP EVENTOS3_3
	AJMP EVENTOS3_4
	AJMP EVENTOS3_5
	AJMP EVENTOS3_6
	AJMP EVENTOS3_7
	AJMP EVENTOS3_8
	AJMP EVENTOS3_9
	AJMP EVENTOS3_10
	AJMP EVENTOS3_11
	AJMP EVENTOS3_12
	AJMP EVENTOS3_13
	AJMP EVENTOS3_14
	AJMP EVENTOS3_15
	AJMP EVENTOS3_16
	AJMP EVENTOS3_17
	AJMP EVENTOS3_18
	AJMP EVENTOS3_19
	AJMP EVENTOS3_20
	AJMP EVENTOS3_21
	AJMP EVENTOS3_22
	AJMP EVENTOS3_23

EVENTOS3_0:
	RET

EVENTOS3_1:
	RET

EVENTOS3_2:
	RET

EVENTOS3_3:
	RET

EVENTOS3_4:
	RET

EVENTOS3_5:
	RET

EVENTOS3_6:
	RET

EVENTOS3_7:
	RET

EVENTOS3_8:
     MOV ESTADO, #0x04
     SETB EV_AGUA
     SETB EV_JABON
     CLR BMOV_FRONT
     MOV EVENTO, #0x00
	RET

EVENTOS3_9:
	RET

EVENTOS3_10:
	RET

EVENTOS3_11:
	RET

EVENTOS3_12:
	RET

EVENTOS3_13:
	RET

EVENTOS3_14:
	RET

EVENTOS3_15:
	RET

EVENTOS3_16:
	RET

EVENTOS3_17:
	RET

EVENTOS3_18:
	RET

EVENTOS3_19:
	RET

EVENTOS3_20:
	RET

EVENTOS3_21:
	RET

EVENTOS3_22:
	RET

EVENTOS3_23:
	RET




;#########################################################################
;			ESTADO 4
;#########################################################################

ENJABONADO:
	ACALL MAQ_EVENTOS_4
	RET

MAQ_EVENTOS_4:
	MOV A, EVENTO
	RL A
	MOV DPTR, #LISTA_EV_4
	JMP @A+DPTR

LISTA_EV_4:
	AJMP EVENTOS4_0
	AJMP EVENTOS4_1
	AJMP EVENTOS4_2
	AJMP EVENTOS4_3
	AJMP EVENTOS4_4
	AJMP EVENTOS4_5
	AJMP EVENTOS4_6
	AJMP EVENTOS4_7
	AJMP EVENTOS4_8
	AJMP EVENTOS4_9
	AJMP EVENTOS4_10
	AJMP EVENTOS4_11
	AJMP EVENTOS4_12
	AJMP EVENTOS4_13
	AJMP EVENTOS4_14
	AJMP EVENTOS4_15
	AJMP EVENTOS4_16
	AJMP EVENTOS4_17
	AJMP EVENTOS4_18
	AJMP EVENTOS4_19
	AJMP EVENTOS4_20
	AJMP EVENTOS4_21
	AJMP EVENTOS4_22
	AJMP EVENTOS4_23

EVENTOS4_0:
	RET

EVENTOS4_1:
	RET

EVENTOS4_2:
	RET

EVENTOS4_3:
	RET

EVENTOS4_4:
	RET

EVENTOS4_5:
	RET

EVENTOS4_6:
	RET

EVENTOS4_7:
	RET

EVENTOS4_8:
	RET

EVENTOS4_9:
     
     CLR EV_AGUA
     CLR EV_JABON
     MOV EVENTO, #0x00
     ; avanza 40cm mas: AQUI SE INICIA UNA TIMER DE 4s (CUANDO PASEN 4s --> IR AL EVENTO 10)
	RET

EVENTOS4_10:

     MOV ESTADO, #0x05
     SETB RV_INTO
     ;AQUI HAY QUE HACER LO DEL PMW CON LA VELOCIDAD DE ROTACION DE LOS RODILLOS
     MOV EVENTO, #0x00

	RET

EVENTOS4_11:
	RET

EVENTOS4_12:
	RET

EVENTOS4_13:
	RET

EVENTOS4_14:
	RET

EVENTOS4_15:
	RET

EVENTOS4_16:
	RET

EVENTOS4_17:
	RET

EVENTOS4_18:
	RET

EVENTOS4_19:
	RET

EVENTOS4_20:
	RET

EVENTOS4_21:
	RET

EVENTOS4_22:
	RET

EVENTOS4_23:
	RET


;#########################################################################
;			ESTADO 5
;#########################################################################

LIMPIAR_ATRAS:
	ACALL MAQ_EVENTOS_5
	RET

MAQ_EVENTOS_5:
	MOV A, EVENTO
	RL A
	MOV DPTR, #LISTA_EV_5
	JMP @A+DPTR
LISTA_EV_5:
	AJMP EVENTOS5_0
	AJMP EVENTOS5_1
	AJMP EVENTOS5_2
	AJMP EVENTOS5_3
	AJMP EVENTOS5_4
	AJMP EVENTOS5_5
	AJMP EVENTOS5_6
	AJMP EVENTOS5_7
	AJMP EVENTOS5_8
	AJMP EVENTOS5_9
	AJMP EVENTOS5_10
	AJMP EVENTOS5_11
	AJMP EVENTOS5_12
	AJMP EVENTOS5_13
	AJMP EVENTOS5_14
	AJMP EVENTOS5_15
	AJMP EVENTOS5_16
	AJMP EVENTOS5_17
	AJMP EVENTOS5_18
	AJMP EVENTOS5_19
	AJMP EVENTOS5_20
	AJMP EVENTOS5_21
	AJMP EVENTOS5_22
	AJMP EVENTOS5_23

EVENTOS5_0:
	RET

EVENTOS5_1:
	RET

EVENTOS5_2:
	RET

EVENTOS5_3:
	RET

EVENTOS5_4:
	RET

EVENTOS5_5:
	RET

EVENTOS5_6:
	RET

EVENTOS5_7:
	RET

EVENTOS5_8:
	RET

EVENTOS5_9:
	RET

EVENTOS5_10:
	RET

EVENTOS5_11:
	RET

EVENTOS5_12:
	RET

EVENTOS5_13:
	RET

EVENTOS5_14:
	RET

EVENTOS5_15:
	RET

EVENTOS5_16:
     
     CLR RV_OUTTO
     MOV ESTADO, #0x06
     SETB BMOV_BACK
     MOV EVENTO, #0x00
	RET

EVENTOS5_17:

     CLR RV_INTO
     SETB RV_OUTTO
     MOV EVENTO #0x00
	RET

EVENTOS5_18:
	RET

EVENTOS5_19:
	RET

EVENTOS5_20:
	RET

EVENTOS5_21:
	RET

EVENTOS5_22:
	RET

EVENTOS5_23:
	RET



;#########################################################################
;			ESTADO 6
;#########################################################################

PONER_RODILLOS:
	ACALL MAQ_EVENTOS_6
	RET

MAQ_EVENTOS_6:
	MOV A, EVENTO
	RL A
	MOV DPTR, #LISTA_EV_6
	JMP @A+DPTR

LISTA_EV_6:
	AJMP EVENTOS6_0
	AJMP EVENTOS6_1
	AJMP EVENTOS6_2
	AJMP EVENTOS6_3
	AJMP EVENTOS6_4
	AJMP EVENTOS6_5
	AJMP EVENTOS6_6
	AJMP EVENTOS6_7
	AJMP EVENTOS6_8
	AJMP EVENTOS6_9
	AJMP EVENTOS6_10
	AJMP EVENTOS6_11
	AJMP EVENTOS6_12
	AJMP EVENTOS6_13
	AJMP EVENTOS6_14
	AJMP EVENTOS6_15
	AJMP EVENTOS6_16
	AJMP EVENTOS6_17
	AJMP EVENTOS6_18
	AJMP EVENTOS6_19
	AJMP EVENTOS6_20
	AJMP EVENTOS6_21
	AJMP EVENTOS6_22
	AJMP EVENTOS6_23

EVENTOS6_0:
	RET

EVENTOS6_1:
	RET

EVENTOS6_2:
	RET

EVENTOS6_3:
	RET

EVENTOS6_4:
	RET

EVENTOS6_5:
	RET

EVENTOS6_6:
	RET

EVENTOS6_7:
	RET

EVENTOS6_8:

     SETB RH_DOWNTO
     SETB RV_INTO
     CLR BMOV_BACK
     MOV EVENTO, #0x00

	RET

EVENTOS6_9:
	RET

EVENTOS6_10:
	RET

EVENTOS6_11:
;acciones
	RET

EVENTOS6_12:
	RET

EVENTOS6_13:
	RET

EVENTOS6_14:
	RET

EVENTOS6_15:
	RET

EVENTOS6_16:
	RET

EVENTOS6_17:
	RET

EVENTOS6_18:
	RET

EVENTOS6_19:
	RET

EVENTOS6_20:
	RET

EVENTOS6_21:
	RET

EVENTOS6_22:
	RET

EVENTOS6_23:
	RET


;#########################################################################
;			ESTADO 7
;#########################################################################

RODILLOS:
	ACALL MAQ_EVENTOS_7
	RET

MAQ_EVENTOS_7:
	MOV A, EVENTO
	RL A
	MOV DPTR, #LISTA_EV_7
	JMP @A+DPTR

LISTA_EV_7:
	AJMP EVENTOS7_0
	AJMP EVENTOS7_1
	AJMP EVENTOS7_2
	AJMP EVENTOS7_3
	AJMP EVENTOS7_4
	AJMP EVENTOS7_5
	AJMP EVENTOS7_6
	AJMP EVENTOS7_7
	AJMP EVENTOS7_8
	AJMP EVENTOS7_9
	AJMP EVENTOS7_10
	AJMP EVENTOS7_11
	AJMP EVENTOS7_12
	AJMP EVENTOS7_13
	AJMP EVENTOS7_14
	AJMP EVENTOS7_15
	AJMP EVENTOS7_16
	AJMP EVENTOS7_17
	AJMP EVENTOS7_18
	AJMP EVENTOS7_19
	AJMP EVENTOS7_20
	AJMP EVENTOS7_21
	AJMP EVENTOS7_22
	AJMP EVENTOS7_23

EVENTOS7_0:
	RET

EVENTOS7_1:
	RET

EVENTOS7_2:
	RET

EVENTOS7_3:
	RET

EVENTOS7_4:
	RET

EVENTOS7_5:
	RET

EVENTOS7_6:
	RET

EVENTOS7_7:
	RET

EVENTOS7_8:
	RET

EVENTOS7_9:
	RET

EVENTOS7_10:
	RET

EVENTOS7_11:
	RET

EVENTOS7_12:
;acciones
	RET

EVENTOS7_13:
;acciones
	RET

EVENTOS7_14:
;acciones
	RET

EVENTOS7_15:
;acciones
	RET

EVENTOS7_16:
	RET

EVENTOS7_17:
	RET

EVENTOS7_18:
;acciones
	RET

EVENTOS7_19:
	RET

EVENTOS7_20:
	RET

EVENTOS7_21:
	RET

EVENTOS7_22:
	RET

EVENTOS7_23:
	RET


;#########################################################################
;			ESTADO 8
;#########################################################################

LIMPIAR_DELANTE:
	ACALL MAQ_EVENTOS_8
	RET

MAQ_EVENTOS_8:

	MOV A, EVENTO
	RL A
	MOV DPTR, #LISTA_EV_8
	JMP @A+DPTR

LISTA_EV_8:
	AJMP EVENTOS8_0
	AJMP EVENTOS8_1
	AJMP EVENTOS8_2
	AJMP EVENTOS8_3
	AJMP EVENTOS8_4
	AJMP EVENTOS8_5
	AJMP EVENTOS8_6
	AJMP EVENTOS8_7
	AJMP EVENTOS8_8
	AJMP EVENTOS8_9
	AJMP EVENTOS8_10
	AJMP EVENTOS8_11
	AJMP EVENTOS8_12
	AJMP EVENTOS8_13
	AJMP EVENTOS8_14
	AJMP EVENTOS8_15
	AJMP EVENTOS8_16
	AJMP EVENTOS8_17
	AJMP EVENTOS8_18
	AJMP EVENTOS8_19
	AJMP EVENTOS8_20
	AJMP EVENTOS8_21
	AJMP EVENTOS8_22
	AJMP EVENTOS8_23

EVENTOS8_0:
	RET

EVENTOS8_1:
	RET

EVENTOS8_2:
	RET

EVENTOS8_3:
	RET

EVENTOS8_4:
	RET

EVENTOS8_5:
	RET

EVENTOS8_6:
	RET

EVENTOS8_7:
	RET

EVENTOS8_8:
	RET

EVENTOS8_9:
	RET

EVENTOS8_10:
	RET

EVENTOS8_11:
	RET

EVENTOS8_12:
	RET

EVENTOS8_13:
	RET

EVENTOS8_14:
	RET

EVENTOS8_15:
	RET

EVENTOS8_16:
	RET

EVENTOS8_17:
	RET

EVENTOS8_18:
	RET

EVENTOS8_19:
;acciones
	RET

EVENTOS8_20:
;acciones
	RET

EVENTOS8_21:
	RET

EVENTOS8_22:
	RET

EVENTOS8_23:
	RET


;#########################################################################
;			ESTADO 9
;#########################################################################

ACLARADO:
	ACALL MAQ_EVENTOS_9
	RET

MAQ_EVENTOS_9:
	MOV A, EVENTO
	RL A
	MOV DPTR, #LISTA_EV_9
	JMP @A+DPTR

LISTA_EV_9:
	AJMP EVENTOS9_0
	AJMP EVENTOS9_1
	AJMP EVENTOS9_2
	AJMP EVENTOS9_3
	AJMP EVENTOS9_4
	AJMP EVENTOS9_5
	AJMP EVENTOS9_6
	AJMP EVENTOS9_7
	AJMP EVENTOS9_8
	AJMP EVENTOS9_9
	AJMP EVENTOS9_10
	AJMP EVENTOS9_11
	AJMP EVENTOS9_12
	AJMP EVENTOS9_13
	AJMP EVENTOS9_14
	AJMP EVENTOS9_15
	AJMP EVENTOS9_16
	AJMP EVENTOS9_17
	AJMP EVENTOS9_18
	AJMP EVENTOS9_19
	AJMP EVENTOS9_20
	AJMP EVENTOS9_21
	AJMP EVENTOS9_22
	AJMP EVENTOS9_23

EVENTOS9_0:
	RET

EVENTOS9_1:
	RET

EVENTOS9_2:
	RET

EVENTOS9_3:
	RET

EVENTOS9_4:
	RET

EVENTOS9_5:
	RET

EVENTOS9_6:
	RET

EVENTOS9_7:
	RET

EVENTOS9_8:
	RET

EVENTOS9_9:
	RET

EVENTOS9_10:
	RET

EVENTOS9_11:
	RET

EVENTOS9_12:
	RET

EVENTOS9_13:
	RET

EVENTOS9_14:
	RET

EVENTOS9_15:
	RET

EVENTOS9_16:
	RET

EVENTOS9_17:
	RET

EVENTOS9_18:
	RET

EVENTOS9_19:
;acciones (igual un nuevo evento)
	RET

EVENTOS9_20:
	RET

EVENTOS9_21:
;acciones
	RET

EVENTOS9_22:
	RET

EVENTOS9_23:
	RET

;#########################################################################
;			ESTADO 10
;#########################################################################

SECADO:
	ACALL MAQ_EVENTOS_10
	RET

MAQ_EVENTOS_10:
	MOV A, EVENTO
	RL A
	MOV DPTR, #LISTA_EV_10
	JMP @A+DPTR

LISTA_EV_10:
	AJMP EVENTOS10_0
	AJMP EVENTOS10_1
	AJMP EVENTOS10_2
	AJMP EVENTOS10_3
	AJMP EVENTOS10_4
	AJMP EVENTOS10_5
	AJMP EVENTOS10_6
	AJMP EVENTOS10_7
	AJMP EVENTOS10_8
	AJMP EVENTOS10_9
	AJMP EVENTOS10_10
	AJMP EVENTOS10_11
	AJMP EVENTOS10_12
	AJMP EVENTOS10_13
	AJMP EVENTOS10_14
	AJMP EVENTOS10_15
	AJMP EVENTOS10_16
	AJMP EVENTOS10_17
	AJMP EVENTOS10_18
	AJMP EVENTOS10_19
	AJMP EVENTOS10_20
	AJMP EVENTOS10_21
	AJMP EVENTOS10_22
	AJMP EVENTOS10_23

EVENTOS10_0:
	RET

EVENTOS10_1:
	RET

EVENTOS10_2:
	RET

EVENTOS10_3:
	RET

EVENTOS10_4:
	RET

EVENTOS10_5:
	RET

EVENTOS10_6:
	RET

EVENTOS10_7:
	RET

EVENTOS10_8:
	RET

EVENTOS10_9:
	RET

EVENTOS10_10:
	RET

EVENTOS10_11:
	RET

EVENTOS10_12:
	RET

EVENTOS10_13:
	RET

EVENTOS10_14:
	RET

EVENTOS10_15:
	RET

EVENTOS10_16:
	RET

EVENTOS10_17:
	RET

EVENTOS10_18:
	RET

EVENTOS10_19:
	RET

EVENTOS10_20:
	RET

EVENTOS10_21:
	RET

EVENTOS10_22:
;acciones
	RET

EVENTOS10_23:
	RET


;#########################################################################
;			ESTADO 11
;#########################################################################

RETIRAR_COCHE:
	ACALL MAQ_EVENTOS_11
	RET

MAQ_EVENTOS_11:
	MOV A, EVENTO
	RL A
	MOV DPTR, #LISTA_EV_11
	JMP @A+DPTR

LISTA_EV_11:
	AJMP EVENTOS11_0
	AJMP EVENTOS11_1
	AJMP EVENTOS11_2
	AJMP EVENTOS11_3
	AJMP EVENTOS11_4
	AJMP EVENTOS11_5
	AJMP EVENTOS11_6
	AJMP EVENTOS11_7
	AJMP EVENTOS11_8
	AJMP EVENTOS11_9
	AJMP EVENTOS11_10
	AJMP EVENTOS11_11
	AJMP EVENTOS11_12
	AJMP EVENTOS11_13
	AJMP EVENTOS11_14
	AJMP EVENTOS11_15
	AJMP EVENTOS11_16
	AJMP EVENTOS11_17
	AJMP EVENTOS11_18
	AJMP EVENTOS11_19
	AJMP EVENTOS11_20
	AJMP EVENTOS11_21
	AJMP EVENTOS11_22
	AJMP EVENTOS11_23

EVENTOS11_0:
	RET

EVENTOS11_1:
	RET

EVENTOS11_2:
	RET

EVENTOS11_3:
	RET

EVENTOS11_4:
	RET

EVENTOS11_5:
	RET

EVENTOS11_6:
	RET

EVENTOS11_7:
	RET

EVENTOS11_8:
	RET

EVENTOS11_9:
	RET

EVENTOS11_10:
	RET

EVENTOS11_11:
	RET

EVENTOS11_12:
	RET

EVENTOS11_13:
	RET

EVENTOS11_14:
	RET

EVENTOS11_15:
	RET

EVENTOS11_16:
	RET

EVENTOS11_17:
	RET

EVENTOS11_18:
	RET

EVENTOS11_19:
	RET

EVENTOS11_20:
	RET

EVENTOS11_21:
	RET

EVENTOS11_22:
	RET

EVENTOS11_23:
;acciones
	RET



END